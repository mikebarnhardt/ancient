.checkbox {
  position: relative;
}

.checkbox input {
  opacity: 0;
  position: absolute;
  z-index: -1;
}

.checkbox label {
  cursor: pointer;

  color: hsl(
    var(--hue, var(--base-hue)),
    var(--saturation, var(--base-saturation)),
    var(--text, var(--base-text))
  );

  display: inline-block;
  font-weight: normal;
  padding-left: 2em;
  user-select: none;
}

/* box */

.checkbox label::before {
  border-color: hsl(
    var(--hue, var(--base-hue)),
    var(--saturation, var(--base-saturation)),
    var(--border, var(--base-border))
  );

  border-radius: 0.25em;
  border-style: solid;
  border-width: 1px;
  content: "";
  height: 1em;
  left: 0;
  position: absolute;
  top: 0.25em;

  transition: var(
    --prefers-reduced-motion,
    background-color 160ms, border-color 160ms, box-shadow 160ms
  );

  width: 1em;
}

.checkbox label:hover::before {
  border-color: hsla(
    var(--hue, var(--base-hue)),
    var(--saturation, var(--base-saturation)),
    calc(var(--border, var(--base-border)) + var(--border-hover-delta, var(--base-border-hover-delta)))
  );
}

.checkbox input[type="checkbox"]:focus ~ label::before {
  border-color: hsl(
    var(--hue, var(--base-hue)),
    var(--saturation, var(--base-saturation)),
    calc(var(--border, var(--base-border)) + var(--border-active-delta, var(--base-border-active-delta)))
  );

  box-shadow:
    0 0 0 0.1875em
    hsla(
      var(--hue, var(--base-hue)),
      var(--saturation, var(--base-saturation)),
      calc(var(--border, var(--base-border)) + var(--border-active-delta, var(--base-border-active-delta))),
      0.25
  );
}

.checkbox label:active::before {
  border-color: hsl(
    var(--hue, var(--base-hue)),
    var(--saturation, var(--base-saturation)),
    calc(var(--border, var(--base-border)) + var(--border-active-delta, var(--base-border-active-delta)))
  );

  box-shadow:
    0 0 0 0.1875em
    hsla(
      var(--hue, var(--base-hue)),
      var(--saturation, var(--base-saturation)),
      calc(var(--border, var(--base-border)) + var(--border-active-delta, var(--base-border-active-delta))),
      0.25
  );
}

.checkbox input[type="checkbox"]:checked ~ label::before {
  background-color: hsl(
    var(--hue, var(--base-hue)),
    var(--saturation, var(--base-saturation)),
    var(--background, var(--base-background))
  );

  border-color: transparent;
}

.checkbox input[type="checkbox"]:checked ~ label:hover::before {
  background-color: hsl(
    var(--hue, var(--base-hue)),
    var(--saturation, var(--base-saturation)),
    calc(var(--background, var(--base-background)) + var(--hover-delta, var(--base-hover-delta)))
  );
}

.checkbox input[type="checkbox"]:checked:focus ~ label::before {
  background-color: hsl(
    var(--hue, var(--base-hue)),
    var(--saturation, var(--base-saturation)),
    calc(var(--background, var(--base-background)) + var(--active-delta, var(--base-active-delta)))
  );

  box-shadow:
    0 0 0 0.1875em
    hsla(
      var(--hue, var(--base-hue)),
      var(--saturation, var(--base-saturation)),
      calc(var(--background, var(--base-background)) + var(--border-active-delta, var(--base-border-active-delta))),
      0.25
  );
}

.checkbox input[type="checkbox"]:checked ~ label:active::before {
  background-color: hsl(
    var(--hue, var(--base-hue)),
    var(--saturation, var(--base-saturation)),
    calc(var(--background, var(--base-background)) + var(--active-delta, var(--base-active-delta)))
  );

  box-shadow:
    0 0 0 0.1875em
    hsla(
      var(--hue, var(--base-hue)),
      var(--saturation, var(--base-saturation)),
      calc(var(--background, var(--base-background)) + var(--border-active-delta, var(--base-border-active-delta))),
      0.25
  );
}

/* check */

.checkbox label::after {
  background-color: transparent;
  border-color: transparent;
  border-radius: 0;
  border-style: solid;
  border-width: 0 1px 1px 0;
  content: "";
  height: 0.5em;
  left: 0.375em;
  position: absolute;
  top: 0.4375em;
  transform: rotate(45deg);

  transition: var(
    --prefers-reduced-motion,
    background-color 160ms, border-color 160ms, box-shadow 160ms, transform 160ms
  );

  width: 0.25em;
}

.checkbox label:hover::after {
  border-color: hsl(
    var(--hue, var(--base-hue)),
    var(--saturation, var(--base-saturation)),
    var(--text, var(--base-text))
  );
}

.checkbox label:active::after {
  transform: rotate(45deg) scale(0.8);
}

.checkbox input[type="checkbox"]:checked ~ label::after {
  border-color: hsl(
    var(--hue, var(--base-hue)),
    var(--saturation, var(--base-saturation)),
    var(--color, var(--base-color))
  );
}

.checkbox input[type="checkbox"]:checked ~ label:active::after {
  transform: rotate(45deg) scale(0.8);
}